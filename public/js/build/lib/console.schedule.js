define(["../helpers/utils","../ext/strftime"],function(g,h){var d,e,f;f=React.createClass({displayName:"ScheduleTask",render:function(){var a,b;a=(this.props.task.duration+1E3*this.props.task.directions.duration.value)*this.props.microSecondWidth;b=((new Date(this.props.task.directions.schedule.ini)).getTime()-this.props.timelineBoundaries.ini.getTime())*this.props.microSecondWidth;b+=3*this.props.index;return React.DOM.div({className:"scheduleTask",style:{width:a+"px",left:b+"px"}})}});e=React.createClass({displayName:"ScheduleTimeLine",
render:function(){return React.DOM.div({className:"panel scheduleTimeLine"},React.DOM.div(null,this.props.tasks.map(function(a,b){return f({key:a.task,task:a,index:b,microSecondWidth:this.props.microSecondWidth,timelineBoundaries:this.props.timelineBoundaries})}.bind(this))))}});d=React.createClass({displayName:"ScheduleRow",render:function(){return React.DOM.div({className:"scheduleRow"},React.DOM.div({className:"scheduleLabels"},React.DOM.span({className:"success label"},this.props.schedule.name)),
e({tasks:this.props.schedule.tasks,microSecondWidth:this.props.microSecondWidth,timelineBoundaries:this.props.timelineBoundaries}))}});return React.createClass({displayName:"ScheduleView",getInitialState:function(){return{microSecondWidth:null}},calcDimensions:function(){if(this.isMounted()){var a=$(this.refs.container.getDOMNode()).width(),b={ini:Infinity,end:-Infinity},c=-Infinity;_.forEach(this.props.schedule,function(a){c=Math.max(a.tasks.length,c);_.forEach(a.tasks,function(a){var c=new Date(a.directions.schedule.ini);
a=new Date(a.schedule.end);c<b.ini&&(b.ini=c);a>b.end&&(b.end=a)})});a=(a-5*c)/(b.end.getTime()-b.ini.getTime());this.setState({microSecondWidth:a,timelineBoundaries:b})}},componentDidUpdate:function(){setTimeout(this.calcDimensions,300)},componentDidMount:function(){setTimeout(this.calcDimensions,300)},render:function(){return React.DOM.div({id:"Schedule"},React.DOM.div({id:"ScheduleContainer",ref:"container"},null!==this.state.microSecondWidth?this.props.schedule.map(function(a){return d({key:a._id,
schedule:a,microSecondWidth:this.state.microSecondWidth,timelineBoundaries:this.state.timelineBoundaries})}.bind(this)):React.DOM.p(null,"...")))}})});
