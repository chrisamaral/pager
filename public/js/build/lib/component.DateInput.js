/** @jsx React.DOM */define(["../helpers/utils","../ext/strftime"],function(e,t){function s(e){function t(e,t){return t==="y"?_.isString(e)&&e.length===4?e:(e+"____").substr(0,4):_.isString(e)&&e.length===2?e:(e+"__").substr(0,2)}var n=e.replace(/\D/g,""),e=n.substr(6,2),r=n.substr(4,2),i=n.substr(0,4);return t(i,"y")+"-"+t(r,"m")+"-"+t(e,"d")}var n,r=Modernizr.inputtypes.date,i;return i=React.createClass({displayName:"MaskedDate",getInitialState:function(){var e=t("%Y-%m-%d",new Date);return{value:e,initial:e}},validDate:function(t){var n=t.currentTarget,r=e.doGetCaretPosition(n),i=s(n.value),o=this.state.value.charAt(r-1),u=this.state.value.charAt(r),a=i.charAt(r-1),f=i.charAt(r);o+u==="-_"&&a+f!=="-_"&&(r+=1),this.setState({value:i},function(){e.setCaretPosition(this.refs.input.getDOMNode(),r)})},render:function(){return React.DOM.input({name:this.props.inputName,ref:"input",required:!0,type:"text",onChange:this.validDate,value:this.state.value,placeholder:this.state.initial})}}),n=React.createClass({displayName:"NativeDate",render:function(){return React.DOM.input({name:this.props.inputName,required:!0,type:"date",defaultValue:this.props.date||(new Date).toYMD()})}}),r?n:i});