define(["../helpers/utils","../ext/strftime"],function(g,h){function k(a){function b(a,b){return"y"===b?_.isString(a)&&4===a.length?a:(a+"____").substr(0,4):_.isString(a)&&2===a.length?a:(a+"__").substr(0,2)}var c=a.replace(/\D/g,"");a=c.substr(6,2);var f=c.substr(4,2),c=c.substr(0,4);return b(c,"y")+"-"+b(f,"m")+"-"+b(a,"d")}var d,l=Modernizr.inputtypes.date,e;e=React.createClass({displayName:"MaskedDate",getInitialState:function(){var a=h("%Y-%m-%d",new Date);return{value:a,initial:a}},validDate:function(a){a=
a.currentTarget;var b=g.doGetCaretPosition(a);a=k(a.value);var c=this.state.value.charAt(b-1),f=this.state.value.charAt(b),d=a.charAt(b-1),e=a.charAt(b);"-_"===c+f&&"-_"!==d+e&&(b+=1);this.setState({value:a},function(){g.setCaretPosition(this.refs.input.getDOMNode(),b)})},render:function(){return React.DOM.input({name:this.props.inputName,ref:"input",required:!0,type:"text",onChange:this.validDate,value:this.state.value,placeholder:this.state.initial})}});d=React.createClass({displayName:"NativeDate",
render:function(){return React.DOM.input({name:this.props.inputName,required:!0,type:"date",defaultValue:this.props.date||(new Date).toYMD()})}});return l?d:e});
